# Investigation-05: Malware Execution

## Case Overview

This investigation focuses on suspicious activities conducted by an employee named **Karen** at **TAAUSAI**. The goal is to analyze a Linux-based forensic disk image of Karen’s workstation to uncover potential insider threats, credential dumping, and malicious activity.

The lab simulates a Security Operations Center (SOC) analyst workflow, examining system logs, Bash history, downloaded files, and artifacts using **FTK Imager**.

---

# Steps Performed (Full Walkthrough)

Below is the full list of steps taken during the investigation.
You can paste any terminal output or FTK Imager details directly into the **Output Section** after each step when filling in your repo.

---

### **Step 1 — Load Disk Image in FTK Imager**

* Opened FTK Imager → *File* → *Add Evidence Item* → *Image File*.
* Selected the Linux `.ad1` evidence.
* Verified integrity using MD5 & SHA1 hashes.

---

### **Step 2 — Identify Linux Distribution**

* Navigated to: `/var/boot/root/syslog`
* Searched for distribution banner or kernel build tag.

---

### **Step 3 — Extract Apache Access Log Hash**

* Navigated to `/var/log/apache2/access.log`.
* Exported the file.
* Generated MD5 hash using hashing tool.

---

### **Step 4 — Identify Downloaded Malware Tool**

* Opened `/root/Downloads/`.
* Located suspicious ZIP archive (Mimikatz).

---

### **Step 5 — Analyze .bash_history**

* Navigated to `/root/.bash_history`.
* Located command used to create the “SuperSecretFile”.
* Identified program executed on the image file (`binwalk`).

---

### **Step 6 — Review Checklist**

* Opened `/root/Desktop/Checklist`.
* Identified the third goal of the attacker.

---

### **Step 7 — Check Apache Execution**

* Opened `/var/log/apache2/`.
* Checked log file sizes to determine if Apache ever ran.

---

### **Step 8 — Identify Remote Attack Evidence**

* Located suspicious file: `irZLAohL.jpeg`.
* Confirmed it originated from FlightSim attack tests.

---

### **Step 9 — Bash Script Taunt**

* Opened: `/root/Documents/myfirsthack/firstscript_fixed`.
* Found taunt keyword.

---

### **Step 10 — Privilege Escalation Evidence**

* Examined `/var/log/auth.log`.
* Located multiple `su` attempts by user `KarenHacker`.

---

### **Step 11 — Last Working Directory**

* From `.bash_history`, identified last directory navigated to.

---

# Output Section (Paste Your Findings Here)

Paste all your extracted outputs underneath each header.

---

### **Output for Task 1 — Linux Distribution**

```
PASTE OUTPUT HERE
```

---

### **Output for Task 2 — MD5 Hash of access.log**

```
PASTE HASH HERE
```

---

### **Output for Task 3 — Downloaded Tool**

```
PASTE FILE NAME / DETAILS HERE
```

---

### **Output for Task 4 — SuperSecret File Creation**

```
PASTE BASH HISTORY LINES HERE
```

---

### **Output for Task 5 — Program Used on Image File**

```
PASTE BASH HISTORY COMMAND HERE
```

---

### **Output for Task 6 — Checklist Goal 3**

```
PASTE CONTENT HERE
```

---

### **Output for Task 7 — Apache Log Check**

```
PASTE LOG FILE SIZE / SCREENSHOT NOTES HERE
```

---

### **Output for Task 8 — Attack Evidence**

```
PASTE FINDINGS HERE
```

---

### **Output for Task 9 — Taunt**

```
PASTE WORD HERE
```

---

### **Output for Task 10 — su to root**

```
PASTE AUTH.LOG EXCERPT HERE
```

---

### **Output for Task 11 — Current Working Directory**

```
PASTE DIRECTORY HERE
```

---

# Tasks and Findings

### Task 1: Linux Distribution

**Action:** Verified the integrity of the evidence using FTK Imager hashing and examined `/var/boot/root/syslog`.
**Finding:** Linux distribution detected: **[Insert distribution here]**

---

### Task 2: MD5 Hash of Apache `access.log`

**Action:** Extracted `access.log` and generated MD5 hash.
**Finding:** **[Insert MD5 hash here]**

---

### Task 3: Downloaded Credential Dumping Tool

**Action:** Checked `/root/Downloads/`.
**Finding:** **Mimikatz**
<img width="1074" height="520" alt="image" src="https://github.com/user-attachments/assets/64966168-0909-4476-b8bf-cbe4a774188a" />

---

### Task 4: Super-Secret File

**Action:** Analyzed `.bash_history`.
**Finding:**

```
touch snky snky > /root/Desktop/SuperSecretFile.txt
```

Absolute path: `/root/Desktop/SuperSecretFile.txt`
<img width="1510" height="708" alt="image" src="https://github.com/user-attachments/assets/64add285-fecd-42eb-acd0-26ffc116d396" />

---

### Task 5: Program Used on `didyouthinkwedmakeiteasy.jpg`

**Action:** Analyzed `.bash_history`.
**Finding:** `binwalk didyouthinkwedmakeiteasy.jpg`
<img width="1028" height="750" alt="image" src="https://github.com/user-attachments/assets/725bbcc2-b72a-43cf-bb28-e2ac026015f1" />

---

### Task 6: Third Goal from Checklist

**Action:** Opened `Checklist` file.
**Finding:** **[Insert third goal]**
<img width="1550" height="758" alt="image" src="https://github.com/user-attachments/assets/e489cf30-6bbb-46d2-a1e0-b9228ddf2d9f" />

---

### Task 7: Apache Execution Count

**Action:** Checked logs.
**Finding:** Apache **never ran** (0 KB logs).
<img width="966" height="572" alt="image" src="https://github.com/user-attachments/assets/06eacc27-5438-401e-bcb7-84e70f433cc7" />

---

### Task 8: Evidence of Attacking Another Machine

**Action:** Found `irZLAohL.jpeg`.
**Finding:** Confirms **FlightSim attack**.
<img width="1258" height="762" alt="image" src="https://github.com/user-attachments/assets/040072d5-98ee-4ab8-89b7-1581add4395e" />

---

### Task 9: Bash Script Taunt

**Action:** Opened script.
**Finding:** Taunt word: **Young**
<img width="982" height="618" alt="image" src="https://github.com/user-attachments/assets/00f8a803-40b3-4ad1-af43-16c616154a67" />

---

### Task 10: User Switching to Root

**Action:** Checked auth logs.
**Finding:** User `KarenHacker` used `su` at **11:26**.
<img width="1700" height="838" alt="image" src="https://github.com/user-attachments/assets/21f42941-6c27-4283-93fb-5ddd07aa6553" />

---

### Task 11: Current Working Directory

**Action:** Checked `.bash_history`.
**Finding:** `/root/Documents/myfirsthack/`
<img width="1054" height="784" alt="image" src="https://github.com/user-attachments/assets/cd45312e-07b5-4d79-9c2f-b8b4db3adaff" />

---

## Tools Used

* FTK Imager
* Bash history analysis
* Apache log inspection
* Binwalk

---

## Notes

This case demonstrates how insider threats and potential malware execution can be traced through logs, artifacts, and forensic disk images.
